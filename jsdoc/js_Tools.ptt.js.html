<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: js/Tools.ptt.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: js/Tools.ptt.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * 
 */
var ToolSettingType = {
	BUTTONS: 1,
	SMALLBUTTONS: 2,
	RANGE: 3,
	CHECKBOX: 4
};

/**
 * Tools...
 * @constructor
 */
function Tools() {
	this.toolbarWidth = 80;
	this.selectedTool = null;
	
	this.color = null;
	this.opacity = 1;
};

/**
 * 
 */
Tools.prototype.init = function() {
	this.$toolbar = $(".toolbar");
	this.$toolbar.width(this.toolbarWidth);
	this.$toolbarContent = $('&lt;div class="toolbarContent" />');
	
	this.$tools = $('&lt;section class="tools" />');
	this.$toolbarContent.append(this.$tools);
	
	this.$settings = $('&lt;section class="settings" />');
	this.$toolbarContent.append(this.$settings);
	
	this.$toolbarContent.append(this.initColors())
	this.$toolbar.append(this.$toolbarContent);
};

/**
 * 
 */
Tools.prototype.initColors = function() {
	var self = this, colorId;
	
	// source: http://flatuicolors.co/
	this.colorIds = [
		"#34495E", // dark
		"#7F8C8D", // gray
		"#9B59B6", // purple
		"#2980B9", // blue
		"#16A085", // green
		"#652623", // brown
		"#E74C3C", // red
		"#F1C40F" // yellow
	];
	
	this.$colors = $('&lt;section class="colors" />');
	
	this.$colorpicker = $('&lt;input type="color" class="colorpicker" maxlength="7" />').on("change keyup", function() {
		if ($(this).val().length == 7) {
			self.selectColor($(this).val());
		}
	});
	this.$colors.append(this.$colorpicker);
	
	for (var i in this.colorIds) {
		this["$color" + i] = $('&lt;div class="color" data-color-id="' + i + '" data-color="' + this.colorIds[i].substr(1) + '">' +
			'&lt;div style="background-color: ' + this.colorIds[i] + '" />' +
		'&lt;/div>');
		this["$color" + i].on("click", function() {
			self.selectColor($(this).attr("data-color-id"));
		});
		this.$colors.append(this["$color" + i]);
	}
	this.selectColor(0);
	
	var label = $('&lt;label />').css({
		marginTop: 5,
	}).text("Opacity");
	this.$opacity = $('&lt;input type="range" class="opacity" value="100" min="5" max="100" step="5" />')
		.on("change input", function() {
			self.opacity = parseInt($(this).val()) / 100;
			self.callColorEvents.apply(self);
		});
	this.$colors.append($('&lt;div class="clear" />'));
	this.$colors.append(label);
	this.$colors.append(this.$opacity);
	
	return this.$colors;
};

/**
 * 
 */
Tools.prototype.registerTool = function(toolNr) {
	debug.log("registering");
	
	var toolName = HistoryType.properties[toolNr].toolName,
		settings = HistoryType.properties[toolNr].toolObject.toolSettings[toolName];
	
	// the tool icon in the toolbar
	this["$tool" + toolNr] = $("&lt;div class=\"tool " + toolName + "\" data-tool-id=\"" + toolNr + "\">" + settings.icon + "&lt;/div>");
	this["$tool" + toolNr].click((function(self, toolNr) {
		return function() {
			self.selectTool(toolNr);
		};
	})(this, toolNr));
	this.$tools.append(this["$tool" + toolNr]);
	
	if (toolNr == 1) {
		// select first tool
		this.selectTool(1);
	}
};

/**
 * 
 */
Tools.prototype.getColor = function(color) {
	if (color === undefined) return this.color;
	else if (/^\#([a-fA-F0-9]{6}|[a-fA-F0-9]{3})$/.test(color)) return color.toUpperCase();
	else return this.colorIds[color];
};

/**
 * 
 */
Tools.prototype.selectColor = function(color) {
	var colorId = -1;
	
	color = ("" + color).toUpperCase();
	this.$colors.find(".selected").removeClass("selected");
	
	if (/^\#[A-F0-9]{6}$/.test(color)) {
		for (var i in this.colorIds) {
			if (this.colorIds[i] == color) {
				colorId = i;
				break;
			}
		}
		this.color = color;
	} else {
		colorId = parseInt(color);
		if (colorId &lt; 0 || isNaN(colorId)) colorId = 0;
		else if (colorId >= this.colorIds.length) colorId = this.colorIds.length - 1;
		this.color = this.colorIds[colorId];
	}
	if (colorId != -1) {
		this["$color" + colorId].addClass("selected");
		this.$colorpicker.val(this.color);
	}
	
	this.callColorEvents();
};

/**
 * 
 */
Tools.prototype.callColorEvents = function() {
	// call events
	if (this.selectedTool &amp;&amp; this.selectedTool.colorChanged) this.selectedTool.colorChanged(this.color, this.opacity);
};

/**
 * 
 */
Tools.prototype.callSettingsEvents = function() {
	// call events
	if (this.selectedTool &amp;&amp; this.selectedTool.settingsChanged) this.selectedTool.settingsChanged();
};

/**
 * 
 */
Tools.prototype.selectTool = function(toolNr) {
	this.$tools.find(".selected").removeClass("selected");
	this["$tool" + toolNr].addClass("selected");
	
	this.tool = parseInt(toolNr);
		
	main.board.$board.off(".tool");
	if (this.selectedTool &amp;&amp; this.selectedTool.deinitEvents) {
		this.selectedTool.deinitEvents.apply(this.selectedTool);
	}
	
	var tool = HistoryType.properties[toolNr],
		settings = tool.toolObject.toolSettings[tool.toolName].settings;

	if (settings) this.parseSettings(tool.toolObject, settings);
	else this.$settings.html("");
	
	tool.toolObject.initEvents(toolNr);
	this.selectedTool = tool.toolObject;
};

/**
 * 
 */
Tools.prototype.parseSettings = function(toolObject, settings) {
	this.$settings.html("");
	
	var self = this,
		settingValues = toolObject.settings;
	$.each(settings, function(name) {
		var setting = this;
		
		// label
		if (this.label &amp;&amp; this.type != ToolSettingType.CHECKBOX) {
			self.$settings.append($('&lt;label />').text(this.label));
		}
		
		// type
		switch (this.type) {
			case ToolSettingType.BUTTONS:
			case ToolSettingType.SMALLBUTTONS:
				$.each(this.buttons, function() {
					var button = this,
						$button = $('&lt;div class="setting' + (this.value == settingValues[name] ? ' selected' : '') + '" data-type="' + setting.type + '" />')
							.click(function() {
								self.$settings.find(".selected").removeClass("selected");
								$(this).addClass("selected");
								settingValues[name] = button.value;
								self.callSettingsEvents();
							}).html(this.icon);
					
					self.$settings.append($button);
				});
				break;
			case ToolSettingType.RANGE:
				var value = settingValues[name],
					min = this.min || 0,
					max = this.max || 1,
					step = this.step || .1,
					$range = $('&lt;input type="range" value="' + value + '" min="' + min + '" max="' + max + '" step="' + step + '" />')
						.on("input change", function() {
							settingValues[name] = parseFloat($(this).val());
							self.callSettingsEvents();
						});
				self.$settings.append($range);
				break;
			case ToolSettingType.CHECKBOX:
				var value = settingValues[name],
					min = this.min || 0,
					max = this.max || 1,
					step = this.step || .1,
					$label = $('&lt;label />'),
					$checkbox = $('&lt;input type="checkbox" min="' + min + '" max="' + max + '" step="' + step + '" />')
						.change(function() {
							settingValues[name] = this.checked;
							self.callSettingsEvents();
						}).prop("checked", value);

				$label.append($checkbox);
				$label.append($('&lt;span />').css("width", self.toolbarWidth - 30).text(this.label));
				self.$settings.append($label);
				break;
		}
	});
};
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Board.html">Board</a></li><li><a href="Clock.html">Clock</a></li><li><a href="Contains%2520utility%2520functions%2520for%2520the%2520JsUnit%2520framework.html">Contains utility functions for the JsUnit framework</a></li><li><a href="Debug.html">Debug</a></li><li><a href="Draw.html">Draw</a></li><li><a href="History.html">History</a></li><li><a href="JsUnit.AssertionArgumentError.html">AssertionArgumentError</a></li><li><a href="JsUnit.Error.html">Error</a></li><li><a href="JsUnit.Failure.html">Failure</a></li><li><a href="JsUnitTestSuite.html">JsUnitTestSuite</a></li><li><a href="Main.html">Main</a></li><li><a href="MockXmlHttpRequest.html">MockXmlHttpRequest</a></li><li><a href="Server.html">Server</a></li><li><a href="Tools.html">Tools</a></li></ul><h3>Global</h3><ul><li><a href="global.html#assert">assert</a></li><li><a href="global.html#assertArrayEquals">assertArrayEquals</a></li><li><a href="global.html#assertArrayEqualsIgnoringOrder">assertArrayEqualsIgnoringOrder</a></li><li><a href="global.html#assertContains">assertContains</a></li><li><a href="global.html#assertEquals">assertEquals</a></li><li><a href="global.html#assertEqualsIgnoringOrder">assertEqualsIgnoringOrder</a></li><li><a href="global.html#assertEvaluatesToFalse">assertEvaluatesToFalse</a></li><li><a href="global.html#assertEvaluatesToTrue">assertEvaluatesToTrue</a></li><li><a href="global.html#assertFalse">assertFalse</a></li><li><a href="global.html#assertHashEquals">assertHashEquals</a></li><li><a href="global.html#assertHTMLEquals">assertHTMLEquals</a></li><li><a href="global.html#assertNaN">assertNaN</a></li><li><a href="global.html#assertNotEquals">assertNotEquals</a></li><li><a href="global.html#assertNotNaN">assertNotNaN</a></li><li><a href="global.html#assertNotNull">assertNotNull</a></li><li><a href="global.html#assertNotUndefined">assertNotUndefined</a></li><li><a href="global.html#assertNull">assertNull</a></li><li><a href="global.html#assertObjectEquals">assertObjectEquals</a></li><li><a href="global.html#assertRoughlyEquals">assertRoughlyEquals</a></li><li><a href="global.html#assertTrue">assertTrue</a></li><li><a href="global.html#assertUndefined">assertUndefined</a></li><li><a href="global.html#BroadcastType">BroadcastType</a></li><li><a href="global.html#Chat">Chat</a></li><li><a href="global.html#clearInterval">clearInterval</a></li><li><a href="global.html#clearTimeout">clearTimeout</a></li><li><a href="global.html#createXmlHttpRequest">createXmlHttpRequest</a></li><li><a href="global.html#Cursor">Cursor</a></li><li><a href="global.html#error">error</a></li><li><a href="global.html#fail">fail</a></li><li><a href="global.html#hash">hash</a></li><li><a href="global.html#HistoryType">HistoryType</a></li><li><a href="global.html#isTestPageLoaded">isTestPageLoaded</a></li><li><a href="global.html#JSUNIT_UNDEFINED_VALUE">JSUNIT_UNDEFINED_VALUE</a></li><li><a href="global.html#JsUnitError">JsUnitError</a></li><li><a href="global.html#JsUnitFailure">JsUnitFailure</a></li><li><a href="global.html#Selection">Selection</a></li><li><a href="global.html#setInterval">setInterval</a></li><li><a href="global.html#setTimeout">setTimeout</a></li><li><a href="global.html#Shape">Shape</a></li><li><a href="global.html#Table">Table</a></li><li><a href="global.html#Text">Text</a></li><li><a href="global.html#ToolSettingType">ToolSettingType</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.2</a> on Thu Sep 17 2015 21:50:02 GMT+0200 (CEST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
